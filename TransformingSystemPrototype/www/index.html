<!DOCTYPE html>
<html>
<head>
    <!--
        Customize the content security policy in the meta tag below as needed. Add 'unsafe-inline' to default-src to enable inline JavaScript.
        For details, see http://go.microsoft.com/fwlink/?LinkID=617521
    -->

    <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
    <!--<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">-->
    <!--/*Remve flicker page - http://rickluna.com/wp/2013/06/preventing-jquery-mobile-page-flicker/ START*/-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <!--/*Remve flicker page END*/-->

    <link href="css/index.css" rel="stylesheet" />

    <script type="text/javascript" src="scripts/underscore-min.js"></script>


    <!--Transforming system sunburst graph START-->
    <script src="scripts/d3.min.js"></script>
    <script src="scripts/systemDashboard.js"></script>
    <!--<script src="scripts/systemDashboard_1.js"></script>-->
    <!--Transforming system sunburst graph END-->

    <!--https://kenwheeler.github.io/slick/ START-->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick-theme.min.css" />

    <!--Initialize your slider in your script file or an inline script tag-->
    <script type="text/javascript">
        $(document).on('ready', function () {
            $(".regular").slick({
                dots: false,
                infinite: false,
                speed: 300,
                slidesToShow: 1,
                adaptiveHeight: false
            });
        });
    </script>
    <!--https://kenwheeler.github.io/slick/ END-->

    <!--https://jquerymobile.com/ START-->
    <link href="css/jquery.mobile-1.4.5.min.css" rel="stylesheet" />
    <script src="scripts/jquery.mobile-1.4.5.min.js"></script>
    <!--https://jquerymobile.com/ END-->

    <!--External Panel - http://demos.jquerymobile.com/1.4.0/panel-external/--> 
    <script>
        $(function () {
            $("body>[data-role='panel']").panel().enhanceWithin();
        });
        //CSS Panel - http://stackoverflow.com/questions/20393239/jquery-mobile-external-panel-not-taking-on-styling
        $(function () {
            $("[data-role=panel]").panel().enhanceWithin();
        });
    </script>

    <style>
        /* Remove flicking footer */
        .ui-page .ui-footer-fixed.ui-fixed-hidden {
            left: 0;
            right: 0;
            width: 100%;
            position: fixed;
            z-index: 1000;
        }
        
        .ui-content {
            padding: 1em !important;
            padding-top: 1em !important;
        }

        /*Remvove highlight from slick.js - https://stackoverflow.com/questions/32468430/slick-js-remove-blue-highlight-around-image */
        .slick-slide {
            outline: none;
        }

        /*Remove overflow hidden - https://stackoverflow.com/questions/8718384/why-is-my-header-text-being-truncated */
        .ui-header .ui-title {
            margin-right: 10%;
            margin-left: 10%;
        }

        /*CSS for Panel*/
        .ui-panel {
            background: white;
            width: 11em;
        }

        /*CSS for Panel buttons*/
        .ui-btn {
            font-size: 11px;
            margin: -0.5em 0;
            padding: 1.2em 1em;
            text-align: left;
            white-space: normal;
        }
        
        /*Remve flicker page - http://rickluna.com/wp/2013/06/preventing-jquery-mobile-page-flicker/ START*/
        body {
            /* Setting body margins to 0 to have proper positioning of #container div */
            margin: 0;
        }
 
            /* #container div with absolute position and 100% width and height so it takes up whole window */
        #container {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .ui-page {
            -webkit-backface-visibility: hidden;
        }

        body {
            overflow: hidden;
        }
        /*Remve flicker page END*/

    </style>

    <title>TransformingSystemPrototype</title>

</head>
<body id="deviceready">

    <!-- Start of first page: #one -->
    <div data-role="page" id="one" data-theme="a">
        <div data-role="header"  data-position="fixed">
            <h1 id="titleMain1"></h1>
            <a href="#left-panel" data-role="button" data-inline="true" data-icon="grid" data-iconpos="notext"></a>
        </div><!-- /header -->
        <div role="main" class="ui-content">
            <div class="regular slider">
                <div>
                    <div id="canvas_container_1_Page_1"></div>
                    <script>
                        dashboard("canvas_container_1_Page_1");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_2_Page_1"></div>
                    <script>
                        dashboard("canvas_container_2_Page_1");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_3_Page_1"></div>
                    <script>
                        dashboard("canvas_container_3_Page_1");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_4_Page_1"></div>
                    <script>
                        dashboard("canvas_container_4_Page_1");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_5_Page_1"></div>
                    <script>
                        dashboard("canvas_container_5_Page_1");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_6_Page_1"></div>
                    <script>
                        dashboard("canvas_container_6_Page_1");
                    </script>
                </div>
            </div>
            <div id="results"></div>
        </div><!-- /content -->
             <!--Remove flicker in footer - http://stackoverflow.com/questions/14125271/jquery-mobile-persistent-navbar-flickers-->
        <div data-position="fixed" data-tap-toggle="false" data-role="footer" data-id="myfooter" data-theme="a">
            &nbsp; &copy; Transforming Systems 2016.
        </div><!-- /footer -->
    </div><!-- /page one -->

    <!-- Start of second page: #two -->
    <div data-role="page" id="two" data-theme="a">
        <div data-role="header" data-position="fixed">
            <h1 id="titleMain2"></h1>
            <a href="#left-panel" data-role="button" data-inline="true" data-icon="grid" data-iconpos="notext"></a>
        </div><!-- /header -->
        <div role="main" class="ui-content">
            <div class="regular slider">
                <div>
                    <div id="canvas_container_1_Page_2"></div>
                    <script>
                        dashboard("canvas_container_1_Page_2");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_2_Page_2"></div>
                    <script>
                        dashboard("canvas_container_2_Page_2");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_3_Page_2"></div>
                    <script>
                        dashboard("canvas_container_3_Page_2");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_4_Page_2"></div>
                    <script>
                        dashboard("canvas_container_4_Page_2");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_5_Page_2"></div>
                    <script>
                        dashboard("canvas_container_5_Page_2");
                    </script>
                </div>
                <div>
                    <div id="canvas_container_6_Page_2"></div>
                    <script>
                        dashboard("canvas_container_6_Page_2");
                    </script>
                </div>
            </div>
        </div><!-- /content -->

        <!--Remove flicker in footer - http://stackoverflow.com/questions/14125271/jquery-mobile-persistent-navbar-flickers-->
        <div data-position="fixed" data-tap-toggle="false" data-role="footer" data-id="myfooter" data-theme="a">
            &nbsp; &copy; Transforming Systems 2016.
        </div><!-- /footer -->
    </div><!-- /page two -->

    <!-- Start of second page: #three -->
    <div data-role="page" id="three" data-theme="a">
        <div data-role="header" data-position="fixed">
            <h1 id="titleMain3"></h1>
            <a href="#left-panel" data-role="button" data-inline="true" data-icon="grid" data-iconpos="notext"></a>
        </div><!-- /header -->
        <div role="main" class="ui-content">
            <!--terms container-->
            <div id="termsText"></div>
        </div><!-- /content -->
        <!--Remove flicker in footer - http://stackoverflow.com/questions/14125271/jquery-mobile-persistent-navbar-flickers-->
        <div data-position="fixed" data-tap-toggle="false" data-role="footer" data-id="myfooter" data-theme="a">
            &nbsp; &copy; Transforming Systems 2016.
        </div><!-- /footer -->
    </div><!-- /page three -->

    <!--External Panel-->
    <div data-role="panel" id="left-panel" theme="a" data-display="overlay">
        <p><a href="#one" class="ui-btn ui-shadow ui-corner-all ui-btn-b" id="titleSide1"></a></p>
        <p><a href="#two" class="ui-btn ui-shadow ui-corner-all ui-btn-b"  id="titleSide2"></a></p>
        <p><a href="#three" class="ui-btn ui-shadow ui-corner-all ui-btn-b"  id="titleSide3"></a></p>
    </div><!-- /panel -->

    <!--Google analytics - Track page START-->
    <script>
         document.getElementById("titleSide1").addEventListener("touchstart", function () {
             window.ga.trackView(localStorage.getItem('titlePage1'), '', true);
             window.ga.trackEvent('Status', 'Panel Touch ' + localStorage.getItem('titlePage1'));
         });

         document.getElementById("titleSide2").addEventListener("touchstart", function () {
             window.ga.trackView(localStorage.getItem('titlePage2'), '', true);
             window.ga.trackEvent('Status', 'Panel Touch ' + localStorage.getItem('titlePage2'));
         });

         document.getElementById("titleSide3").addEventListener("touchstart", function () {
             window.ga.trackView(localStorage.getItem('terms'), '', true);
             window.ga.trackEvent('Status', 'Panel Touch ' + localStorage.getItem('terms'));
         });
    </script>
    <!--Google analytics - Track page END-->

    <!--Firebase Database - https://firebase.google.com/docs/database/web/read-and-write START -->
    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
    <script>
        // fire config
        var config = {
            apiKey: "AIzaSyAM3XZsPpodijhSBuPlb1veTSSJaPcJcxM",
            authDomain: "push-dabf6.firebaseapp.com",
            databaseURL: "https://push-dabf6.firebaseio.com",
            storageBucket: "push-dabf6.appspot.com",
            messagingSenderId: "140870032700"
        };


        firebase.initializeApp(config);
        var database = firebase.database();

        // get data from database    
        database.ref().on("value", function (snap) {

            if (localStorage.getItem('titlePage1') != snap.val().page1) {
                localStorage.setItem('titlePage1', snap.val().page1);
                document.getElementById("titleMain1").innerHTML = document.getElementById("titleSide1").innerHTML = localStorage.getItem('titlePage1');
            }

            if (localStorage.getItem('titlePage2') != snap.val().page2) {
                localStorage.setItem('titlePage2', snap.val().page2);
                document.getElementById("titleMain2").innerHTML = document.getElementById("titleSide2").innerHTML = localStorage.getItem('titlePage2');
            }

            if (localStorage.getItem('terms') != snap.val().page3) {
                localStorage.setItem('terms', snap.val().page3);
                document.getElementById("titleMain3").innerHTML = document.getElementById("titleSide3").innerHTML = localStorage.getItem('terms');
            }

            if (localStorage.getItem('termsText') != snap.val().term) {
                localStorage.setItem('termsText', snap.val().term);
                document.getElementById("termsText").innerHTML = localStorage.getItem('termsText');
            }

        });
    </script>
    <!--Firebase Database END -->

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="scripts/index.js"></script>

</body>
</html>
